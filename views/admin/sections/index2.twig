{% extends "admin/layouts/main.twig" %}

{% block aside %}
	{% include 'admin/layouts/partials/aside.twig' with { 'aside': 'landing.sections' } %}
{% endblock %}

{% block breadcrumb %}
    {% include 'admin/layouts/partials/breadcrumb.twig' with { 'breadcrumb': 'landing.sections' } %}
{% endblock %}

{% block css %}
<style>
    .bootstrap-select > .dropdown-toggle.btn-light, .bootstrap-select > .dropdown-toggle.btn-secondary {
        background: #F3F6F9 !important;  
        border-color: #F3F6F9 !important;
        color: #3F4254 !important;      
    }
    .bootstrap-select.show > .dropdown-toggle.btn-light, .bootstrap-select.show > .dropdown-toggle.btn-secondary{
        border-color: #F3F6F9 !important;
    }
    .minicolors-swatch{
        top: 5px !important;
        left: 5px !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="container" id="AppSectionAdmin">
    <div class="card card-custom">
        <div class="card-header flex-wrap border-0 pt-6 pb-0">
            <div class="card-title">
                <h3 class="card-label">Listado de secciones
                <span class="text-muted pt-2 font-size-sm d-block">Gestionar</span></h3>
            </div>
            <div class="card-toolbar">
                <button type="button" class="btn btn-light-primary" @click="onFormModal(-1)">
                    <i class="la la-plus"></i> Nuevo
                </button>
            </div>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover table-checkable" id="kt_datatable" style="margin-top: 13px !important">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>SECCIÓN</th>
                            <th>SUBTITULO</th>
                            <th>COLOR</th>
                            <th>ESTADO</th>
                            <th>FECHA</th>
                            <th>ACCIONES</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="item, index in sections">
                            <td v-html="item.id"></td>
                            <td v-html="item.name"></td>
                            <td v-html="item.caption"></td>
                            <td>
                                <template v-if="item.color">
                                    <div class="d-flex">
                                        <span class="label label-inline font-weight-lighter mr-2" :style="{ 'background-color': item.color }"></span>
                                        <span v-html="item.color"></span>
                                    </div>
                                </template>
                            </td>
                            <td>
                                <template v-if="item.status == 1">
                                    <span class="label label-lg font-weight-bold label-light-success label-inline">Activado</span>
                                </template>
                                <template v-else>
                                    <span class="label label-lg font-weight-bold label-light-danger label-inline">Desactivado</span>
                                </template>
                            </td>
                            <td v-html="item.updated_at"></td>
                            <td>
                                <a href="javascript:;" class="btn btn-sm btn-clean btn-icon" @click="onModalListContent(index)" data-toggle="tooltip" data-placement="top" title="Contenidos">
                                    <i class="la la-list"></i>
                                </a>
                                <a href="javascript:;" class="btn btn-sm btn-clean btn-icon" @click="onFormModal(index)" data-toggle="tooltip" data-placement="top" title="Editar Sección">
                                    <i class="la la-edit"></i>
                                </a>
                                <a href="javascript:;" class="btn btn-sm btn-clean btn-icon" @click="onDelete(index)" data-toggle="tooltip" data-placement="top"  title="Eliminar Sección">
                                    <i class="la la-trash"></i>
                                </a>
                            </td>
                        </tr>                    
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalFormSection" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel" v-text="modal.title">GESTIONAR SECCIÓN</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <i aria-hidden="true" class="ki ki-close"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="form" id="form_save_section" @submit="onFormSave">
                        <div class="col-lg-12">
                            <input type="hidden" :value="section.id" name="id">
                            <div class="form-group">
                                <label>Título</label>
                                <input type="text" class="form-control form-control-solid" :value="section.name" name="name" placeholder="" required/>
                            </div>
                            <div class="form-group">
                                <label>Subtitulo</label>
                                <input type="text" class="form-control form-control-solid" :value="section.caption" name="caption" placeholder=""/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label">Menú</label>
                                <select class="form-control selectpicker mb-5" title="Seleccionar" name="menus[]" multiple="multiple" required>
                                    <option v-for="(item, index) in menus"  :key="item.id" :value="item.id" v-text="item.name"></option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Color</label>
                                <input type="text" class="form-control form-control-solid js-color" :value="section.color" name="color" placeholder=""/>
                            </div>
                            <div class="form-group">
                                <label for="exampleTextarea">Descripción</label>
                                <textarea class="form-control form-control-solid" :value="section.description" rows="4" name="description"></textarea>
                            </div>
                            <div class="form-group">
                                <div class="checkbox-inline">
                                    <label class="checkbox">
                                        <input type="checkbox" name="status" value="1" :checked="section.status == 1 ? true : false"/>
                                        <span></span>
                                        Activar
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary font-weight-bold" data-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary font-weight-bold" form="form_save_section">Guardar</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalListContent" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">GESTIÓN DE CONTENIDOS</h5>
                    {# <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <i aria-hidden="true" class="ki ki-close"></i>
                    </button> #}
                    <a type="button" href="'/admin/landing/contenidos/crear" class="btn btn-sm btn-light-primary">
                        <i class="la la-plus"></i> Nuevo
                    </a>
                </div>
                <div class="modal-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>CONTENIDO</th>
                                <th>ESTADO</th>
                                <th>ACCIONES</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="item, index in contents">
                                <td v-html="item.id"></td>
                                <td v-html="item.name.length ? item.name : item.caption"></td>
                                <td>
                                    <template v-if="item.status == 1">
                                        <span class="label label-lg font-weight-bold label-light-success label-inline">Activado</span>
                                    </template>
                                    <template v-else>
                                        <span class="label label-lg font-weight-bold label-light-danger label-inline">Desactivado</span>
                                    </template>
                                </td>
                                <td>
                                    <a :href="'/admin/landing/contenidos/editar/'+item.id" class="btn btn-sm btn-clean btn-icon" data-toggle="tooltip" data-placement="top" title="Editar">
                                        <i class="la la-edit"></i>
                                    </a>
                                    <a href="javascript:;" class="btn btn-sm btn-clean btn-icon" @click="onDeleteContent(index)" data-toggle="tooltip" data-placement="top" title="Eliminar">
                                        <i class="la la-trash"></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary font-weight-bold" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
    <script>
        window.addEventListener('load', window.AppSectionAdmin.index(JSON.parse("{{ rsp.data|json_encode|e('js') }}")));
    </script>
{% endblock %}